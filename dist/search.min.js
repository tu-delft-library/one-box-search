function X(f){return(E)=>{let m=`${E}`.split(/\s+/g).filter((k)=>k).map(_);return(k)=>{f:for(let $ of m){for(let j of f)if($.test(k[j]))continue f;return!1}return!0}}}function _(f){return new RegExp(`(?:^|[^\\p{L}-])${g(f)}`,"iu")}function g(f){return f.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")}var K=3,M=(f)=>{let E=new Array;if(E.count=0,f)console.error(f),E.error=!0;return E},W=[{id:"catalogue",title:{en:"Catalogue",nl:"Catalogus"},description:{en:"Physical and digital books, media, journals",nl:"Fysieke en digitale boeken, media, tijdschriften"},apiBaseUrl:"https://handler.tudelft.nl/worldcat?type=brief&search=",searchBaseUrl:"https://tudelft.on.worldcat.org/search?queryString=",getRecords:async function(f){try{let E=encodeURIComponent(f),m=await D(this.apiBaseUrl+(E||"*"));if(m){let k=m.results;if(k.briefRecords){let $=k.briefRecords.slice(0,K).map((j)=>({id:j.oclcNumber.toString(),title:j.title,authors:j.creator,href:"https://tudelft.on.worldcat.org/oclc/"+j.oclcNumber,date:j.date}));return $.count=k.numberOfRecords,$}else return M()}else return M()}catch(E){return M(E)}}},{id:"repository",title:{en:"TU Delft Repository",nl:"TU Delft Repository"},description:{en:"Digital archive of TU Delft output",nl:"Digitaal archief van TU Delft output"},apiBaseUrl:"https://repository.tudelft.nl/tudelft/library/search?limit=10&searchterm=",searchBaseUrl:"https://repository.tudelft.nl/search?search_term=",getRecords:async function(f){try{let E=await D(this.apiBaseUrl+encodeURIComponent(f));if(E){let m=E.results,k=+m.total;if(k&&m.searchResults){let $=m.searchResults.slice(0,K).map((j)=>({id:j.thingid.replace("Thing_","uuid:"),title:j.title,authors:j.contributors.map((F)=>F.fullname).join(", "),href:"https://repository.tudelft.nl/record/uuid:"+j.thingid.replace("Thing_",""),date:j.publication_year}));return $.count=k,$}else return M()}else return M()}catch(E){return M(E)}}},{id:"databases",title:{en:"Databases",nl:"Databases"},description:{en:"Recommended resources for the TU Delft community",nl:"Aanbevolen bronnen voor de TU Delft gemeenschap"},apiBaseUrl:"https://filelist.tudelft.nl/Library/Zoeken/databases.json",searchBaseUrl:"https://databases.tudl.tudelft.nl/?t=az&q=",getRecords:async function(f){try{let E=await D(this.apiBaseUrl);if(E){let m=X(["title","keywords","description"]),k=f?E.results.filter(m(f)):E.results,$=k.slice(0,K).map((j)=>({title:j.title,description:j.description.split(" ").slice(0,25).join(" ")+"...",href:j.url}));return $.count=k.length,$}else return M()}catch(E){return M(E)}}},{id:"research-data",title:{en:"Research Data (4TU)",nl:"Research Data (4TU)"},description:{en:"Research datasets, publications, and software",nl:"Onderzoeksdatasets, publicaties en software"},apiBaseUrl:"https://data.4tu.nl/v2/articles/search",searchBaseUrl:"https://data.4tu.nl/search?search=",getRecords:async function(f){try{let E=await D(this.apiBaseUrl,{search_for:f});if(E){let m=E.results;if(m){let k=m.slice(0,K).map((j)=>({id:j.doi,title:j.title,authors:j.authors.map((F)=>F.full_name).join(", "),href:"https://doi.org/"+j.doi,date:j.published_date})),$=E.headers.get("Number-Of-Records");return k.count=$?+$:void 0,k}else return M()}else return M()}catch(E){return M(E)}}},{id:"special-collections",title:{en:"Special Collections",nl:"Bijzondere Collecties"},description:{en:"Academic heritage, Trésor, Map room",nl:"Academisch erfgoed, Trésor, kaartenkamer"},apiBaseUrl:"https://63flhve71t2un5xgp.a1.typesense.net/multi_search?x-typesense-api-key=8EOitKCMTbxUKPZNqUEoQS9M2RGvpkZS",searchBaseUrl:"https://heritage.tudelft.nl/nl/search?production-manifests%5Bquery%5D=",getRecords:async function(f){try{let E=await D(this.apiBaseUrl,{searches:[{query_by:"label,summary,type,plaintext,topic_material,topic_date,topic_contributor,topic_format",highlight_fields:"label,summary",highlight_start_tag:"<mark>",highlight_end_tag:"</mark>",highlight_full_fields:"label,summary,type,plaintext,topic_material,topic_date,topic_contributor,topic_format",collection:"production-manifests",q:f,facet_by:"topic_contributor,topic_date,topic_format,topic_material,type",max_facet_values:10,page:1}]});if(E){let m=E.results;if(m){let k=m.results[0].hits.slice(0,K).map(({document:$})=>({id:$.slug,title:$.label,authors:$.topic_contributor?$.topic_contributor.join(", "):null,href:"https://heritage.tudelft.nl/"+$.slug,date:$.topic_date?$.topic_date[0]:void 0}));return k.count=m.results[0].found,k}else return M()}else return M()}catch(E){return M(E)}}}];var N=(f,...E)=>String.raw({raw:f},...E),Y=void 0,L=(f)=>Y==="nl"?f.nl:f.en;function D(f,E){let m=E?"POST":"GET",k=new Headers,$={method:m,headers:k};if(k.append("Accept","application/json"),E)k.append("Content-Type","application/json"),$.body=JSON.stringify(E);let j=new Request(f,$);return fetch(j).then((F)=>{if(F.ok){let{headers:O}=F;return F.json().then((A)=>({headers:O,results:A}))}else return null})}function G(f){return N`
    <a
      href="${f.href}"
      title="${f.title}"
      target="_blank"
      class="news-summary"
    >
      <section>
        <h3>${f.title}</h3>
        <div class="row">
          <div class="sm-3"></div>
          <div class="sm-9">
            ${f.authors?"<p>"+f.authors+"</p>":""}
            ${f.description?"<p>"+f.description+"</p>":""}
            ${f.date?"<p>Published "+f.date+"</p>":""}
            ${f.id?`<div class="fake-link">${f.id}</div>`:""}
          </div>
        </div>
      </section>
    </a>
  `}function P(f,E,m,k){let{count:$,error:j}=m;return N`
    <div class="t3ce frame-type-gridelements_pi1">
      <div class="grid-background--white grid-background--boxed">
        ${m&&m.length&&$?$.toLocaleString()+L({en:" results",nl:" resultaten"}):m&&m.length?L({en:"Top 3 results",nl:"Top 3 resultaten"}):j?L({en:"Results could not be fetched",nl:"Resultaten konden niet geladen worden"}):L({en:"No results",nl:"Geen resultaten"})}
        <h2>${L(f)}</h2>
        <p><i>${L(E)}</i></p>
        <div class="content-container">
          ${m&&m.length?m.map(G).join(`
`):j?'<div class="news-summary" style="color:#e64616">'+L({en:"Access results through the button below",nl:"Toegang tot de resultaten via onderstaande knop"})+"</div>":""}
          <div class="t3ce frame-type-sitetud_singlebutton">
            <a
              href="${k}"
              target="_blank"
              class="btn btn--single align-center btn--royal_blue"
            >
              ${L({en:"View all results ↗",nl:"Bekijk alle resultaten ↗"})}
            </a>
          </div>
        </div>
      </div>
    </div>
  `}var Q=()=>{return N`<div
    class="t3ce frame-type-text"
    style="margin-bottom:-20px;margin-top:15px;"
  >
    ${L({en:"Search gives results from",nl:"Zoeken geeft resultaten uit"})}
    <a href="#website"
      ><b>${L({en:"this website",nl:"deze website"})}</b></a
    >,
    ${W.map(({id:f,title:E})=>N`<a href="#${f}"><b>${L(E)}</b></a>`).join(", ")}.
  </div>`};async function Z(f,E){Y=E;let m=document.querySelector(".multiRowGrid");if(m){let k=document.querySelector("div.hiddenSidebarContent");if(k){let $=k.innerHTML.split("</form>")[1].trim(),j=Q();k.innerHTML=k.innerHTML.split("</form>")[0]+j;let F=m.querySelector(".sm-12");if(F){F.id="website";let O=F.querySelector("h2");if(O){O.textContent=L({en:"This website",nl:"Deze website"});let V=document.createElement("p");V.style.fontStyle="italic",V.innerText=L({en:"Guidelines, tools, events, news",nl:"Richtlijnen, hulpmiddelen, evenementen en nieuwsberichten"}),O.after(V)}let A=F.querySelector(".btn");if(A)A.textContent=L({en:"View all results",nl:"Bekijk alle resultaten"});F.prepend($?$:L({en:"No results",nl:"Geen resultaten"}))}}W.forEach(async($,j)=>{let F=document.createElement("div");if(F.className="sm-6 md-6 lg-6",F.id=$.id,F.innerHTML=N`
        <div class="t3ce frame-type-gridelements_pi1">
          <div class="grid-background--white grid-background--boxed">
            <span style="color:white">-</span>
            <h2>${L($.title)}</h2>
            <i>${L({en:"Loading...",nl:"Aan het laden..."})}</i>
          </div>
        </div>
      `,j===0)m.prepend(F);else m.append(F);let O=await $.getRecords(f),A=P($.title,$.description,O,$.searchBaseUrl+encodeURIComponent(f));F.innerHTML=A})}}window.onload=()=>{let{value:f}=document.querySelector(".searchForm-input"),E=document.documentElement.lang||"en";document.documentElement.style.setProperty("scroll-behavior","smooth"),Z(f,E)};

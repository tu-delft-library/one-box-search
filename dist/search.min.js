function j(l){return(i)=>{let a=`${i}`.split(/\s+/g).filter((f)=>f).map(B);return(f)=>{l:for(let D of a){for(let M of l)if(D.test(f[M]))continue l;return!1}return!0}}}function B(l){return new RegExp(`(?:^|[^\\p{L}-])${I(l)}`,"iu")}function I(l){return l.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")}var G={Archv:{label:"Archival Material",children:{Digital:{label:"Downloadable Archival Material"}}},ArtChap:{label:"Article",children:{Chmpt:{label:"Chapter"},Digital:{label:"Downloadable article"}}},Audiobook:{label:"Audiobook",children:{CD:{label:"CD"},Digital:{label:"eAudiobook"},LP:{label:"LP"},Cassette:{label:"Cassette"}}},Book:{label:"Book",children:{Braille:{label:"Braille"},Continuing:{label:"Continually Updated Resource"},Digital:{label:"eBook"},LargePrint:{label:"Large Print"},mic:{label:"Microform"},thsis:{label:"Thesis/Dissertation"}}},CompFile:{label:"Computer File"},Encyc:{label:"Encyclopedia"},Game:{label:"Game",children:{Digital:{label:"Video Game"}}},"2d":{label:"Image"},IntMM:{label:"Interactive Multimedia"},Web:{label:"Internet Resource",children:{Digital:{label:"Website"},dwn2d:{label:"Downloadable Image"}}},Jrnl:{label:"Journal/Magazine",children:{Digital:{label:"eJournal/eMagazine"}}},Kit:{label:"Kit"},Map:{label:"Map",children:{Digital:{label:"eMap"}}},Music:{label:"Music",children:{CD:{label:"CD"},Digital:{label:"eMusic"},LP:{label:"LP"},Cassette:{label:"Cassette"}}},MsScr:{label:"Musical Score",children:{Digital:{label:"Downloadable Music Score"}}},News:{label:"Newspaper",children:{Digital:{label:"eNewspaper"}}},Object:{label:"Object"},Snd:{label:"Sound Recording (Other)"},Toy:{label:"Toy"},Video:{label:"Video",children:{Bluray:{label:"Bluray"},Digital:{label:"eVideo"},DVD:{label:"DVD"},Film:{label:"Film"},VHS:{label:"VHS"}}},Vis:{label:"Visual material",children:{Digital:{label:"Downloadable Visual Material"}}}};var h=3,k=(l)=>{let i=new Array;if(i.count=0,l)console.error(l),i.error=!0;return i},O=[{id:"catalogue",title:{en:"Catalogue",nl:"Catalogus"},description:{en:"Physical and digital books, media, journals",nl:"Fysieke en digitale boeken, media, tijdschriften"},apiBaseUrl:"https://handler.tudelft.nl/worldcat?type=brief&search=",searchBaseUrl:"https://tudelft.on.worldcat.org/search?queryString=",getRecords:async function(l){try{let i=encodeURIComponent(l),a=await g(this.apiBaseUrl+(i||"*"));if(a){let f=a.results;if(f.briefRecords){let D=function(b,A){if(!b)return;let C=G[b],L=C.children[A];if(L)return L?.label;return C?.label},M=f.briefRecords.slice(0,h).map((b)=>({id:b.oclcNumber.toString(),title:b.title,authors:b.creator,href:"https://tudelft.on.worldcat.org/oclc/"+b.oclcNumber,date:b.date,type:D(b.generalFormat,b.specificFormat)}));return M.count=f.numberOfRecords,M}else return k()}else return k()}catch(i){return k(i)}}},{id:"repository",title:{en:"TU Delft Repository",nl:"TU Delft Repository"},description:{en:"Digital archive of TU Delft output",nl:"Digitaal archief van TU Delft output"},apiBaseUrl:"https://repository.tudelft.nl/tudelft/library/search?limit=10&searchterm=",searchBaseUrl:"https://repository.tudelft.nl/search?search_term=",getRecords:async function(l){try{let i=await g(this.apiBaseUrl+encodeURIComponent(l));if(i){let a=i.results,f=+a.total,D=a.searchResults&&Array.isArray(a.searchResults);if(f&&D){let M=a.searchResults.slice(0,h).map((b)=>({id:b.thingid.replace("Thing_","uuid:"),title:b.title,authors:b.contributors.map((A)=>A.fullname).join(", "),href:"https://repository.tudelft.nl/record/uuid:"+b.thingid.replace("Thing_",""),date:b.publication_year,type:b.object_type}));return M.count=f,M}else return k()}else return k()}catch(i){return k(i)}}},{id:"databases",title:{en:"Databases",nl:"Databases"},description:{en:"Recommended resources for the TU Delft community",nl:"Aanbevolen bronnen voor de TU Delft gemeenschap"},apiBaseUrl:"https://filelist.tudelft.nl/Library/Zoeken/databases.json",searchBaseUrl:"https://databases.tudl.tudelft.nl/?t=az&q=",getRecords:async function(l){try{let i=await g(this.apiBaseUrl);if(i){let a=j(["title","keywords","description"]),f=l?i.results.filter(a(l)):i.results,D=f.slice(0,h).map((M)=>({title:M.title,description:M.description.split(" ").slice(0,25).join(" ")+"...",href:M.url,type:M.type}));return D.count=f.length,D}else return k()}catch(i){return k(i)}}},{id:"research-data",title:{en:"Research Data (4TU)",nl:"Research Data (4TU)"},description:{en:"Research datasets, publications, and software",nl:"Onderzoeksdatasets, publicaties en software"},apiBaseUrl:"https://data.4tu.nl/v2/articles/search",searchBaseUrl:"https://data.4tu.nl/search?search=",getRecords:async function(l){try{let i=await g(this.apiBaseUrl,{search_for:l});if(i){let a=i.results;if(a){let f=a.slice(0,h).map((M)=>({id:M.doi,title:M.title,authors:M.authors.map((b)=>b.full_name).join(", "),href:"https://doi.org/"+M.doi,date:new Date(M.published_date).getFullYear().toString(),type:M.defined_type_name})),D=i.headers.get("Number-Of-Records");return f.count=D?+D:void 0,f}else return k()}else return k()}catch(i){return k(i)}}},{id:"special-collections",title:{en:"Special Collections",nl:"Bijzondere Collecties"},description:{en:"Academic heritage, Trésor, Map room",nl:"Academisch erfgoed, Trésor, kaartenkamer"},apiBaseUrl:"https://63flhve71t2un5xgp.a1.typesense.net/multi_search?x-typesense-api-key=8EOitKCMTbxUKPZNqUEoQS9M2RGvpkZS",searchBaseUrl:"https://heritage.tudelft.nl/nl/search?production-manifests%5Bquery%5D=",getRecords:async function(l){try{let i=await g(this.apiBaseUrl,{searches:[{query_by:"label,summary,type,plaintext,topic_material,topic_date,topic_contributor,topic_format",highlight_fields:"label,summary",highlight_start_tag:"<mark>",highlight_end_tag:"</mark>",highlight_full_fields:"label,summary,type,plaintext,topic_material,topic_date,topic_contributor,topic_format",collection:"production-manifests",q:l,facet_by:"topic_contributor,topic_date,topic_format,topic_material,type",max_facet_values:10,page:1,sort_by:!l?"_rand():asc":""}]});if(i){let a=i.results;if(a){let f=a.results[0].hits.slice(0,h).map(({document:D})=>({id:D.slug,title:D.label,authors:D.topic_contributor?D.topic_contributor.join(", "):null,href:"https://heritage.tudelft.nl/"+D.slug,date:D.topic_date?D.topic_date[0]:void 0,type:D.type}));return f.count=a.results[0].found,f}else return k()}else return k()}catch(i){return k(i)}}}];var S=(l,...i)=>String.raw({raw:l},...i),K=void 0,V=(l)=>K==="nl"?l.nl:l.en;function g(l,i){let a=i?"POST":"GET",f=new Headers,D={method:a,headers:f};if(f.append("Accept","application/json"),i)f.append("Content-Type","application/json"),D.body=JSON.stringify(i);let M=new Request(l,D);return fetch(M).then((b)=>{if(b.ok){let{headers:A}=b;return b.json().then((C)=>({headers:A,results:C}))}else return null})}function Y(l){return S`
    <a
      href="${l.href}"
      title="${l.title}"
      target="_blank"
      class="news-summary"
    >
      <section>
        ${l.type?`<p class="label" style="
    background-color: #00a6d6;
    color: white;
    border-radius: 50px;
    margin-bottom: 1em;
    padding: 0 1em;
    width: max-content
  ">`+l.type+"</p>":""}
        <h3>${l.title}</h3>
        <div class="row">
          <div class="sm-3"></div>
          <div class="sm-9">
            ${l.authors?"<p>"+l.authors+"</p>":""}
            ${l.description?"<p>"+l.description+"</p>":""}
            ${l.date?"<p>Published "+l.date+"</p>":""}
            ${l.id?`<div class="fake-link">${l.id}</div>`:""}
          </div>
        </div>
      </section>
    </a>
  `}function Z(l,i,a,f){let{count:D,error:M}=a;return S`
    <div class="t3ce frame-type-gridelements_pi1">
      <div class="grid-background--white grid-background--boxed">
        ${a&&a.length&&D?D.toLocaleString()+V({en:" results",nl:" resultaten"}):a&&a.length?V({en:"Top 3 results",nl:"Top 3 resultaten"}):M?V({en:"Results could not be fetched",nl:"Resultaten konden niet geladen worden"}):V({en:"No results",nl:"Geen resultaten"})}
        <h2>${V(l)}</h2>
        <p><i>${V(i)}</i></p>
        <div class="content-container">
          ${a&&a.length?a.map(Y).join(`
`):M?'<div class="news-summary" style="color:#e64616">'+V({en:"Access results through the button below",nl:"Toegang tot de resultaten via onderstaande knop"})+"</div>":""}
          <div class="t3ce frame-type-sitetud_singlebutton">
            <a
              href="${f}"
              target="_blank"
              class="btn btn--single align-center btn--royal_blue"
            >
              ${V({en:"View all results ↗",nl:"Bekijk alle resultaten ↗"})}
            </a>
          </div>
        </div>
      </div>
    </div>
  `}var _=()=>{return S`<div
    class="t3ce frame-type-text"
    style="margin-bottom:-20px;margin-top:15px;"
  >
    ${V({en:"Search gives results from",nl:"Zoeken geeft resultaten uit"})}
    <a href="#website"
      ><b>${V({en:"this website",nl:"deze website"})}</b></a
    >,
    ${O.map(({id:l,title:i})=>S`<a href="#${l}"><b>${V(i)}</b></a>`).join(", ")}.
  </div>`};async function W(l,i){K=i;let a=document.querySelector(".multiRowGrid");if(a){let f=document.querySelector("div.hiddenSidebarContent");if(f){let D=f.innerHTML.split("</form>")[1].trim(),M=_();f.innerHTML=f.innerHTML.split("</form>")[0]+M;let b=a.querySelector(".sm-12");if(b){b.id="website";let A=b.querySelector("h2");if(A){A.textContent=V({en:"This website",nl:"Deze website"});let L=document.createElement("p");L.style.fontStyle="italic",L.innerText=V({en:"Guidelines, tools, events, news",nl:"Richtlijnen, hulpmiddelen, evenementen en nieuwsberichten"}),A.after(L),b.querySelectorAll("a").forEach((N)=>{let $,P=N.getAttribute("href");if(P?.startsWith("/library/")||P?.startsWith("/en/library/"))$={en:"Page",nl:"Pagina"};else if(P?.startsWith("/evenementen/")||P?.startsWith("/en/events/"))$={en:"Event",nl:"Evenement"};else $={en:"News",nl:"Nieuwsbericht"};N.querySelector(".label")?.remove();let E=document.createElement("p");E.setAttribute("class","label"),E.setAttribute("style",`background-color: #00a6d6;
                color: white;
                border-radius: 50px;
                margin-bottom: 1em;
                padding: 0 1em;
                width: max-content`),E.innerText=V($),N?.prepend(E)})}let C=b.querySelector(".btn");if(C)C.textContent=V({en:"View all results",nl:"Bekijk alle resultaten"});b.prepend(D?D:V({en:"No results",nl:"Geen resultaten"}))}}O.forEach(async(D,M)=>{let b=document.createElement("div");if(b.className="sm-6 md-6 lg-6",b.id=D.id,b.innerHTML=S`
        <div class="t3ce frame-type-gridelements_pi1">
          <div class="grid-background--white grid-background--boxed">
            <span style="color:white">-</span>
            <h2>${V(D.title)}</h2>
            <i>${V({en:"Loading...",nl:"Aan het laden..."})}</i>
          </div>
        </div>
      `,M===0)a.prepend(b);else a.append(b);let A=await D.getRecords(l),C=Z(D.title,D.description,A,D.searchBaseUrl+encodeURIComponent(l));b.innerHTML=C})}}window.onload=()=>{let l="";l=document.querySelector(".searchForm-input").value;let a=document.documentElement.lang||"en";document.documentElement.style.setProperty("scroll-behavior","smooth"),W(l,a)};

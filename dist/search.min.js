function h(l){return(i)=>{let b=`${i}`.split(/\s+/g).filter((f)=>f).map(j);return(f)=>{l:for(let a of b){for(let M of l)if(a.test(f[M]))continue l;return!1}return!0}}}function j(l){return new RegExp(`(?:^|[^\\p{L}-])${G(l)}`,"iu")}function G(l){return l.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&")}var E={Archv:{label:"Archival Material",children:{Digital:{label:"Downloadable Archival Material"}}},ArtChap:{label:"Article",children:{Chmpt:{label:"Chapter"},Digital:{label:"Downloadable article"}}},Audiobook:{label:"Audiobook",children:{CD:{label:"CD"},Digital:{label:"eAudiobook"},LP:{label:"LP"},Cassette:{label:"Cassette"}}},Book:{label:"Book",children:{Braille:{label:"Braille"},Continuing:{label:"Continually Updated Resource"},Digital:{label:"eBook"},LargePrint:{label:"Large Print"},mic:{label:"Microform"},thsis:{label:"Thesis/Dissertation"}}},CompFile:{label:"Computer File"},Encyc:{label:"Encyclopedia"},Game:{label:"Game",children:{Digital:{label:"Video Game"}}},"2d":{label:"Image"},IntMM:{label:"Interactive Multimedia"},Web:{label:"Internet Resource",children:{Digital:{label:"Website"},dwn2d:{label:"Downloadable Image"}}},Jrnl:{label:"Journal/Magazine",children:{Digital:{label:"eJournal/eMagazine"}}},Kit:{label:"Kit"},Map:{label:"Map",children:{Digital:{label:"eMap"}}},Music:{label:"Music",children:{CD:{label:"CD"},Digital:{label:"eMusic"},LP:{label:"LP"},Cassette:{label:"Cassette"}}},MsScr:{label:"Musical Score",children:{Digital:{label:"Downloadable Music Score"}}},News:{label:"Newspaper",children:{Digital:{label:"eNewspaper"}}},Object:{label:"Object"},Snd:{label:"Sound Recording (Other)"},Toy:{label:"Toy"},Video:{label:"Video",children:{Bluray:{label:"Bluray"},Digital:{label:"eVideo"},DVD:{label:"DVD"},Film:{label:"Film"},VHS:{label:"VHS"}}},Vis:{label:"Visual material",children:{Digital:{label:"Downloadable Visual Material"}}}};var S=3,g=(l)=>{let i=new Array;if(i.count=0,l)console.error(l),i.error=!0;return i},P=[{id:"catalogue",title:{en:"Catalogue",nl:"Catalogus"},description:{en:"Physical and digital books, media, journals",nl:"Fysieke en digitale boeken, media, tijdschriften"},apiBaseUrl:"https://handler.tudelft.nl/worldcat?type=brief&search=",searchBaseUrl:"https://tudelft.on.worldcat.org/search?queryString=",getRecords:async function(l){try{let i=encodeURIComponent(l),b=await L(this.apiBaseUrl+(i||"*"));if(b){let f=b.results;if(f.briefRecords){let a=function(D,k){if(!D)return;let A=E[D],C=A[k];if(C)return C?.label;return A?.label},M=f.briefRecords.slice(0,S).map((D)=>({id:D.oclcNumber.toString(),title:D.title,authors:D.creator,href:"https://tudelft.on.worldcat.org/oclc/"+D.oclcNumber,date:D.date,type:a(D.generalFormat,D.specificFormat)}));return M.count=f.numberOfRecords,M}else return g()}else return g()}catch(i){return g(i)}}},{id:"repository",title:{en:"TU Delft Repository",nl:"TU Delft Repository"},description:{en:"Digital archive of TU Delft output",nl:"Digitaal archief van TU Delft output"},apiBaseUrl:"https://repository.tudelft.nl/tudelft/library/search?limit=10&searchterm=",searchBaseUrl:"https://repository.tudelft.nl/search?search_term=",getRecords:async function(l){try{let i=await L(this.apiBaseUrl+encodeURIComponent(l));if(i){let b=i.results,f=+b.total,a=b.searchResults&&Array.isArray(b.searchResults);if(f&&a){let M=b.searchResults.slice(0,S).map((D)=>({id:D.thingid.replace("Thing_","uuid:"),title:D.title,authors:D.contributors.map((k)=>k.fullname).join(", "),href:"https://repository.tudelft.nl/record/uuid:"+D.thingid.replace("Thing_",""),date:D.publication_year,type:D.object_type}));return M.count=f,M}else return g()}else return g()}catch(i){return g(i)}}},{id:"databases",title:{en:"Databases",nl:"Databases"},description:{en:"Recommended resources for the TU Delft community",nl:"Aanbevolen bronnen voor de TU Delft gemeenschap"},apiBaseUrl:"https://filelist.tudelft.nl/Library/Zoeken/databases.json",searchBaseUrl:"https://databases.tudl.tudelft.nl/?t=az&q=",getRecords:async function(l){try{let i=await L(this.apiBaseUrl);if(i){let b=h(["title","keywords","description"]),f=l?i.results.filter(b(l)):i.results,a=f.slice(0,S).map((M)=>({title:M.title,description:M.description.split(" ").slice(0,25).join(" ")+"...",href:M.url,type:M.type}));return a.count=f.length,a}else return g()}catch(i){return g(i)}}},{id:"research-data",title:{en:"Research Data (4TU)",nl:"Research Data (4TU)"},description:{en:"Research datasets, publications, and software",nl:"Onderzoeksdatasets, publicaties en software"},apiBaseUrl:"https://data.4tu.nl/v2/articles/search",searchBaseUrl:"https://data.4tu.nl/search?search=",getRecords:async function(l){try{let i=await L(this.apiBaseUrl,{search_for:l});if(i){let b=i.results;if(b){let f=b.slice(0,S).map((M)=>({id:M.doi,title:M.title,authors:M.authors.map((D)=>D.full_name).join(", "),href:"https://doi.org/"+M.doi,date:new Date(M.published_date).getFullYear().toString(),type:M.defined_type_name})),a=i.headers.get("Number-Of-Records");return f.count=a?+a:void 0,f}else return g()}else return g()}catch(i){return g(i)}}},{id:"special-collections",title:{en:"Special Collections",nl:"Bijzondere Collecties"},description:{en:"Academic heritage, Trésor, Map room",nl:"Academisch erfgoed, Trésor, kaartenkamer"},apiBaseUrl:"https://63flhve71t2un5xgp.a1.typesense.net/multi_search?x-typesense-api-key=8EOitKCMTbxUKPZNqUEoQS9M2RGvpkZS",searchBaseUrl:"https://heritage.tudelft.nl/nl/search?production-manifests%5Bquery%5D=",getRecords:async function(l){try{let i=await L(this.apiBaseUrl,{searches:[{query_by:"label,summary,type,plaintext,topic_material,topic_date,topic_contributor,topic_format",highlight_fields:"label,summary",highlight_start_tag:"<mark>",highlight_end_tag:"</mark>",highlight_full_fields:"label,summary,type,plaintext,topic_material,topic_date,topic_contributor,topic_format",collection:"production-manifests",q:l,facet_by:"topic_contributor,topic_date,topic_format,topic_material,type",max_facet_values:10,page:1,sort_by:!l?"_rand():asc":""}]});if(i){let b=i.results;if(b){let f=b.results[0].hits.slice(0,S).map(({document:a})=>({id:a.slug,title:a.label,authors:a.topic_contributor?a.topic_contributor.join(", "):null,href:"https://heritage.tudelft.nl/"+a.slug,date:a.topic_date?a.topic_date[0]:void 0,type:a.type}));return f.count=b.results[0].found,f}else return g()}else return g()}catch(i){return g(i)}}}];var $=(l,...i)=>String.raw({raw:l},...i),N=void 0,V=(l)=>N==="nl"?l.nl:l.en;function L(l,i){let b=i?"POST":"GET",f=new Headers,a={method:b,headers:f};if(f.append("Accept","application/json"),i)f.append("Content-Type","application/json"),a.body=JSON.stringify(i);let M=new Request(l,a);return fetch(M).then((D)=>{if(D.ok){let{headers:k}=D;return D.json().then((A)=>({headers:k,results:A}))}else return null})}function W(l){return $`
    <a
      href="${l.href}"
      title="${l.title}"
      target="_blank"
      class="news-summary"
    >
      <section>
        ${l.type?`<p class="label" style="
    background-color: #00a6d6;
    color: white;
    border-radius: 50px;
    margin-bottom: 1em;
    padding: 0 1em;
    width: max-content
  ">`+l.type+"</p>":""}
        <h3>${l.title}</h3>
        <div class="row">
          <div class="sm-3"></div>
          <div class="sm-9">
            ${l.authors?"<p>"+l.authors+"</p>":""}
            ${l.description?"<p>"+l.description+"</p>":""}
            ${l.date?"<p>Published "+l.date+"</p>":""}
            ${l.id?`<div class="fake-link">${l.id}</div>`:""}
          </div>
        </div>
      </section>
    </a>
  `}function B(l,i,b,f){let{count:a,error:M}=b;return $`
    <div class="t3ce frame-type-gridelements_pi1">
      <div class="grid-background--white grid-background--boxed">
        ${b&&b.length&&a?a.toLocaleString()+V({en:" results",nl:" resultaten"}):b&&b.length?V({en:"Top 3 results",nl:"Top 3 resultaten"}):M?V({en:"Results could not be fetched",nl:"Resultaten konden niet geladen worden"}):V({en:"No results",nl:"Geen resultaten"})}
        <h2>${V(l)}</h2>
        <p><i>${V(i)}</i></p>
        <div class="content-container">
          ${b&&b.length?b.map(W).join(`
`):M?'<div class="news-summary" style="color:#e64616">'+V({en:"Access results through the button below",nl:"Toegang tot de resultaten via onderstaande knop"})+"</div>":""}
          <div class="t3ce frame-type-sitetud_singlebutton">
            <a
              href="${f}"
              target="_blank"
              class="btn btn--single align-center btn--royal_blue"
            >
              ${V({en:"View all results ↗",nl:"Bekijk alle resultaten ↗"})}
            </a>
          </div>
        </div>
      </div>
    </div>
  `}var I=()=>{return $`<div
    class="t3ce frame-type-text"
    style="margin-bottom:-20px;margin-top:15px;"
  >
    ${V({en:"Search gives results from",nl:"Zoeken geeft resultaten uit"})}
    <a href="#website"
      ><b>${V({en:"this website",nl:"deze website"})}</b></a
    >,
    ${P.map(({id:l,title:i})=>$`<a href="#${l}"><b>${V(i)}</b></a>`).join(", ")}.
  </div>`};async function O(l,i){N=i;let b=document.querySelector(".multiRowGrid");if(b){let f=document.querySelector("div.hiddenSidebarContent");if(f){let a=f.innerHTML.split("</form>")[1].trim(),M=I();f.innerHTML=f.innerHTML.split("</form>")[0]+M;let D=b.querySelector(".sm-12");if(D){D.id="website";let k=D.querySelector("h2");if(k){k.textContent=V({en:"This website",nl:"Deze website"});let C=document.createElement("p");C.style.fontStyle="italic",C.innerText=V({en:"Guidelines, tools, events, news",nl:"Richtlijnen, hulpmiddelen, evenementen en nieuwsberichten"}),k.after(C)}let A=D.querySelector(".btn");if(A)A.textContent=V({en:"View all results",nl:"Bekijk alle resultaten"});D.prepend(a?a:V({en:"No results",nl:"Geen resultaten"}))}}P.forEach(async(a,M)=>{let D=document.createElement("div");if(D.className="sm-6 md-6 lg-6",D.id=a.id,D.innerHTML=$`
        <div class="t3ce frame-type-gridelements_pi1">
          <div class="grid-background--white grid-background--boxed">
            <span style="color:white">-</span>
            <h2>${V(a.title)}</h2>
            <i>${V({en:"Loading...",nl:"Aan het laden..."})}</i>
          </div>
        </div>
      `,M===0)b.prepend(D);else b.append(D);let k=await a.getRecords(l),A=B(a.title,a.description,k,a.searchBaseUrl+encodeURIComponent(l));D.innerHTML=A})}}window.onload=()=>{let l="";if(l=document.querySelector(".searchForm-input").value,!l)l=new URLSearchParams(window.location.search).get("q")||"";let b=document.documentElement.lang||"en";document.documentElement.style.setProperty("scroll-behavior","smooth"),O(l,b)};
